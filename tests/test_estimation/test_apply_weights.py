"""Tests for function in apply_weights"""


def test_apply_weights():
    """Test for apply_weights"""


    # Create config dictionary
    config = {"estimation": {"numeric_cols": ["701", "702", "703"]},
              "breakdowns": {"211": ["202", "203", "204"],
                             "305": ["302", "303", "304"],
                             "emp_total": ["emp_researcher", "emp_technician", "emp_other"],
                             "headcount_total": ["headcount_res_m", "headcount_res_f", "headcount_tec_m",
                                                 "headcount_tec_f", "headcount_oth_m", "headcount_oth_f"]}
}


    # Create an input dataframe for the test
    input_columns = [
        "reference",
        "701",
        "702",
        "703",
        "211",
        "202",
        "203",
        "204",
        "305",
        "302",
        "303",
        "304",
        "emp_total",
        "emp_researcher",
        "emp_technician",
        "emp_other",
        "headcount_total",
        "headcount_res_m",
        "headcount_res_f",
        "headcount_tech_m",
        "headcount_tech_f",
        "headcount_oth_m",
        "headcount_oth_f",
        "a_weights",
    ]

    data = [
        ["1", 1.045777935, 1.5968726069999999, 0.254832457, 1501.531337, 500.8443931, 499.9360421, 500.75090159999996, 29.94531777, 9.602584921, 9.653985014, 10.68874783, 6.486029315, 2.533542905, 2.308242877, 1.644243533, 36, 5, 5, 6, 6, 6, 7, 2.5],
        ["2", 1.157775387, 0.484444627, 0.660795649, 1501.150221, 499.7596024, 501.6974991, 499.6931194, 31.82855842, 10.97246129, 10.18047899, 10.67561814, 9.256449084, 3.6957475310000003, 3.053765916, 2.5069356369999998, 31, 5, 5, 5, 5, 5, 5, 6.0],
        ["3", 0.245754563, 0.053153144000000006, 0.24898895399999998, 1499.305683, 499.0019342, 499.56546389999994, 500.7382846, 31.09016923, 10.200109300000001, 11.24314965, 9.646910282999999, 11.18471882, 5.38607754, 2.750773441, 3.047867843, 32, 6, 6, 5, 5, 5, 5, 7.0],
        ["4", 0.091581569, 1.29306045, 2.222550393, 1497.3095039999998, 500.2853801, 498.26926339999994, 498.7548608, 31.49017978, 10.80040763, 9.527649379, 11.16212277, 10.22765186, 3.03791456, 3.8605661610000004, 3.3291711439999996, 19, 3, 5, 3, 3, 3, 3, 14.0],
        ["5", 0.48547690299999996, 0.614760438, 1.620874173, 1498.722371, 500.4694436000001, 500.44068089999996, 497.81224689999993, 30.44836156, 10.06357482, 10.79756546, 9.587221282, 8.654173735, 5.294000296, 2.062538336, 1.297635102, 39, 2, 6, 5, 7, 9, 10, 2.0],
        ["6", 0.216682565, 0.420119477, 0.077609457, 1497.974779, 499.146944, 498.292069, 500.5357663, 29.76051868, 9.465821929, 9.133324308999999, 11.16137244, 11.35927018, 5.351916919, 2.9535873489999998, 3.053765916, 30, 5, 5, 5, 5, 5, 5, 1.0],
        ["7", 0.256570729, 1.635266926, 0.877078037, 1497.8444539999998, 499.91778619999997, 499.7594455, 498.16722269999997, 28.24588485, 9.099873094, 9.312124146, 9.833887614, 11.20396942, 4.079138201, 5.134802344, 1.990028871, 28, 5, 4, 5, 5, 4, 4, 6.3],
        ["8", 0.733170964, 0.111266445, 0.506586275, 1500.596397, 501.64230189999995, 501.381718, 497.5723767, 28.169746500000002, 9.444435161, 9.593212578, 9.132098765, 10.80790153, 3.316276783, 4.322564458, 3.169060286, 35, 5, 8, 5, 6, 6, 6, 8.1],
        ["9", 2.134056558, 0.31692025, 1.3120006770000001, 1498.986525, 501.01687419999996, 499.2999597, 498.66969119999993, 31.76279059, 10.04786784, 10.48995616, 11.22496658, 8.855932629, 4.065679953, 2.443454044, 2.346798631, 33, 5, 6, 5, 6, 6, 6, 1.0],
        ["10", 0.678504648, 0.35838638700000003, 0.569093572, 1498.674708, 500.2971126, 500.64281950000003, 497.7347761, 30.178638399999997, 9.173285232000001, 11.11531108, 9.890042091, 10.35101118, 3.143504622, 3.1301464180000003, 4.077360139, 32, 4, 4, 5, 6, 6, 7, 9.0],
    ]

    input_df = pandasDF(data=data, columns=input_columns)



